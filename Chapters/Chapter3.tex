\section{微分同胚}
\subsection{双射}
设 $f$ 是集合 $A$ 到 $B$ 的映照。
如果 $A$ 中不同的元素有不同的像，则称 $f$ 为\emphA{单射}（也叫“一对一”）；
如果 $B$ 中每个元素都是 $A$ 中元素的像，则称 $f$ 为\emphA{满射}；
如果 $f$ 既是单射又是满射，则称 $f$ 为\emphA{双射}（也叫“一一对应”）。
三种情况的示意见图~\ref{fig:单射满射双射}。

\begin{figure}[h]
	\centering
	\includegraphics{Images/Three_Mappings.PNG}
	\caption{单射、满射与双射}
	\label{fig:单射满射双射}
\end{figure}

设开集 $\domD{\V{X}},\,\domD{\V{x}}\subset\Rm$，
它们之间存在\emphB{双射}，即\emphB{一一对应}关系：
\begin{equation}
	\mmap{\V{X}(\V{x})}
		{\domD{\V{x}}\ni\V{x}=\mqty[x^1 \\ \vdots \\ x^m]}
		{\V{X}(\V{x})=\mqty[X^1 \\ \vdots \\ X^m](\V{x})
			\in\domD{\V{X}}} \fullstop
\end{equation}
由于该映照实现了 $\domD{\V{x}}$ 到 $\domD{\V{X}}$ 之间的双射，
因此它存在逆映照：
\begin{equation}
	\mmap{\V{x}(\V{X})}
		{\domD{\V{X}}\ni\V{X}=\mqty[X^1 \\ \vdots \\ X^m]}
		{\V{x}(\V{X})=\mqty[x^1 \\ \vdots \\ x^m](\V{X})
			\in\domD{\V{x}}} \fullstop
\end{equation}

我们把 $\domD{\V{X}}$ 称为\emphA{物理域}，它是实际物理事件发生的区域；
$\domD{\V{x}}$ 则称为\emphA{参数域}。
由于物理域通常较为复杂，因此我们常把参数域取为规整的形状，以便之后的处理。

设物理量 $f(\V{X})$ 定义在物理域
$\domD{\V{X}}\subset\Rm$ 上\footnote{
	实际的物理事件当然只会发生在三维 Euclid 空间中（只就“空间”而言），
	但在数学上也可以推广到 $m$ 维。
}，则 $f$ 就定义了一个\emphA{场}：
\begin{equation}
	\mmap{f}
		{\domD{\V{X}}\ni\V{X}}
		{f(\V{X})} \fullstop
\end{equation}
所谓的“场”，就是自变量用\emphB{位置}刻画的映照。
它可以是\emphA{标量场}，如温度、压强、密度等，此时 $f(\V{X})\in\realR$；
也可以是\emphA{向量场}，如速度、加速度、力等，此时 $f(\V{X})\in\Rm$；
对于更深入的物理、力学研究，往往还需引入\emphA{张量场}，
此时 $f(\V{X})\in\Tensors{r}$。

$\V{X}$ 存在于物理域 $\domD{\V{X}}$ 中，我们称它为\emphA{物理坐标}。
由于上文已经定义了 $\domD{\V{x}}$ 到 $\domD{\V{X}}$ 之间的双射
（不是 $f$！），因此 $\domD{\V{x}}$ 中就有\emphB{唯一的}
$\V{x}$ 与 $\V{X}$ 相对应，
它称为\emphA{参数坐标}（也叫\emphA{曲线坐标}）。
又因为物理域 $\domD{\V{X}}$ 上已经定义了场 $f(\V{X})$，
参数域中必然\emphB{唯一}存在场 $\tilde{f}(\V{x})$ 与之对应：
\begin{equation}
	\mmap{\tilde{f}}
		{\domD{\V{x}}\ni\V{x}}
		{\tilde{f}(\V{x})=f\comp\V{X}(\V{x})
			=f\qty\big(\V{X}(\V{x}))} \fullstop
\end{equation}
$\V{x}$ 与 $\V{X}$ 是完全等价的，因而 $\tilde{f}$ 与 $f$ 也是完全等价的，
所以同样有
\begin{equation}
	f(\V{X})=\tilde{f}\qty\big(\V{x}(\V{X})) \fullstop
\end{equation}

物理域中的场要满足\emphB{守恒定律}，如质量守恒、动量守恒、能量守恒等。
从数学上看，这些守恒定律就是 $f(\V{X})$ 需要满足的一系列\emphB{偏微分方程}。
将场变换到参数域后，它仍要满足这些方程。
但我们已经设法将参数域取得较为规整，故在其上进行数值求解就会相当方便。

\subsection{参数域方程} \label{subsec:参数域方程}
上文已经提到，物理域中的场 $f(\V{X})$ 需满足守恒定律，
这等价于一系列偏微分方程（PDE）。
在物理学和力学中，用到的 PDE 通常是\emphB{二阶}的，它们可以写成
\begin{equation}
	\forall\,\V{X}\in\domD{\V{X}},\quad
	\sum_{\alpha=1}^{m} A_\alpha(\V{X}) \pdv{f}{X^\alpha} (\V{X})
	+\sum_{\alpha=1}^{m}\sum_{\beta=1}^{m}
		B_{\alpha\beta}(\V{X}) \pdv{f}{X^\beta}{X^\alpha} (\V{X}) = 0
\end{equation}
的形式。我们的目标是把该\emphB{物理域}方程转化为\emphB{参数域}方程，
即关于 $\tilde{f}(\V{x})$ 的 PDE。
多元微积分中已经提供了解决方案：\emphA{链式求导法则}。

考虑到
\begin{equation}
	f(\V{X})=\tilde{f}\qty\big(\V{x}(\V{X}))
	=\tilde{f}\qty(x^1(\V{X}),\,\cdots,\,x^m(\V{X})) \comma
\end{equation}
于是有
\begin{equation}
	\pdv{f}{X^\alpha} (\V{X})
	=\sum_{s=1}^{m} \pdv{\tilde{f}}{\displaystyle x^s}
		\qty\big(\V{x}(\V{X})) \cdotp
		\pdv{x^s}{X^\alpha} (\V{X}) \fullstop
	\label{eq:参数域方程_一阶偏导项}
\end{equation}
这里用到的链式法则，由\emphB{复合映照可微性定理}驱动，
它要求 $\tilde{f}$ 关于 $\V{x}$ 可微，同时 $\V{x}$ 关于 $\V{X}$ 可微。

\myPROBLEM{对于更高阶的项，往往需要更强的条件。}一般地，我们要求
\begin{braceEq}
	\V{X}(\V{x})&\in\cf{\domD{\V{x}}}{\Rm} \semicomma \\
	\V{x}(\V{X})&\in\cf{\domD{\V{X}}}{\Rm} \fullstop
\end{braceEq}
这里的 $\DiffMorp$ 指\emphB{直至 $p$ 阶偏导数（存在且）连续}的映照全体；
$p=1$ 时，它就等价于可微。至于 $p$ 的具体取值，则由 PDE 的阶数所决定。

通常情况下，已知条件所给定的往往都是
$\domD{\V{x}}$ 到 $\domD{\V{X}}$ 的映照
\begin{equation}
	\mmap{\V{X}(\V{x})}
		{\domD{\V{x}}\ni\V{x}=\mqty[x^1 \\ \vdots \\ x^m]}
		{\V{X}(\V{x})=\mqty[X^1 \\ \vdots \\ X^m](\V{x})
			\in\domD{\V{X}}} \comma
\end{equation}
用它不好直接得到式~\eqref{eq:参数域方程_一阶偏导项} 中的
$\pdv*{x^s}{X^\alpha}$ 项，但获得它的“倒数”
$\pdv*{X^\alpha}{x^s}$ 却很容易，只需利用 \emphA{Jacobi 矩阵}：
\begin{equation}
	\JacobiD{\V{X}}(\V{x})
	\defeq\mqty[
		\displaystyle\pdv{X^1}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^1}{\displaystyle x^m} \\[1ex]
		\vdots & \ddots & \vdots \\[0.5ex]
		\displaystyle\pdv{X^m}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^m}{\displaystyle x^m}
		]\, (\V{x}) \in\realR^{m \times m} \comma
	\label{eq:参数域方程_Jacobi矩阵}
\end{equation}
它是一个方阵。

有了 Jacobi 矩阵，施加一些手法就可以得到所需要的 $\pdv*{x^s}{X^\alpha}$ 项。
考虑到
\begin{equation}
	\forall\,\V{X}\in\domD{\V{X}},\quad
	\V{X}\qty\big(\V{x}(\V{X}))=\V{X} \comma
\end{equation}
并且其中的 $\V{X}(\V{x})$ 和 $\V{x}(\V{X})$ 均可微，可以得到
\begin{equation}
	\JacobiD{\V{X}}\qty\big(\V{x}(\V{X}))
	\cdotp \JacobiD{\V{x}}(\V{X})
	=\Mat{I}_m \comma
\end{equation}
其中的 $\Mat{I}_m$ 是单位阵。因此
\begin{equation}
	\JacobiD{\V{x}}(\V{X})
	\defeq\mqty[
		\displaystyle\pdv{x^1}{\displaystyle X^1} & \cdots &
			\displaystyle\pdv{x^1}{\displaystyle X^m} \\[1ex]
		\vdots & \ddots & \vdots \\[0.5ex]
		\displaystyle\pdv{x^m}{\displaystyle X^1} & \cdots &
			\displaystyle\pdv{x^m}{\displaystyle X^m} ]\, (\V{X})
	=(\JacobiD{\V{X}})^{-1}(\V{x})
	=\mqty[
		\displaystyle\pdv{X^1}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^1}{\displaystyle x^m} \\[1ex]
		\vdots & \ddots & \vdots \\[0.5ex]
		\displaystyle\pdv{X^m}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^m}{\displaystyle x^m}
		]^{-1} (\V{x}) \fullstop
\end{equation}
用代数的方法总可以求出
\begin{equation}
	\varphi^s_\alpha\coloneq\pdv{x^s}{X^\alpha}(\V{X}) \comma
	\label{eq:Jacobi矩阵的元素}
\end{equation}
它是通过求逆运算确定的函数，
即位于矩阵 $\JacobiD{\V{x}}$ 第 $s$ 行第 $\alpha$ 列的元素。这样就有
\begin{equation}
	\pdv{f}{X^\alpha} (\V{X})
	=\sum_{s=1}^{m} \pdv{\tilde{f}}{\displaystyle x^s}
		\qty\big(\V{x}(\V{X})) \cdotp
		\varphi^s_\alpha \qty\big(\V{x}(\V{X})) \fullstop
\end{equation}

接下来处理二阶偏导数。由上式，
\begin{align}
	\pdv{f}{X^\beta}{X^\alpha} (\V{X})
	&=\sum_{s=1}^{m} \Bigg[ \qty\Bigg(\sum_{k=1}^{m}
			\pdv{\tilde{f}}{\displaystyle x^k}{\displaystyle x^s}
			\qty\big(\V{x}(\V{X})) \cdotp \pdv{x^s}{X^\beta} (\V{X}) )
		\cdotp \varphi^s_\alpha \qty\big(\V{x}(\V{X})) \notag \\
	&\alspace\phantom{\sum_{s=1}^{m} \Bigg[ }+
		\pdv{\tilde{f}}{\displaystyle x^s}
		\qty\big(\V{x}(\V{X})) \cdotp \qty\Bigg(\sum_{k=1}^{m}
			\pdv{\displaystyle \varphi^s_\alpha}{\displaystyle x^k}
			\qty\big(\V{x}(\V{X}))
			\cdotp \pdv{\displaystyle x^k}{X^\beta} (\V{X}) )
		\Bigg] \notag
	\intertext{继续利用式~\eqref{eq:Jacobi矩阵的元素}，有}
	&=\sum_{s=1}^{m} \Bigg[ \qty\Bigg(\sum_{k=1}^{m}
			\pdv{\tilde{f}}{\displaystyle x^k}{\displaystyle x^s}
			\qty\big(\V{x}(\V{X})) \cdotp
			\varphi^s_\beta \qty\big(\V{x}(\V{X})) )
		\cdotp \varphi^s_\alpha \qty\big(\V{x}(\V{X})) \notag \\
	&\alspace\phantom{\sum_{s=1}^{m} \Bigg[ }+
		\pdv{\tilde{f}}{\displaystyle x^s}
		\qty\big(\V{x}(\V{X})) \cdotp \qty\Bigg(\sum_{k=1}^{m}
			\pdv{\displaystyle \varphi^s_\alpha}{\displaystyle x^k}
			\qty\big(\V{x}(\V{X}))
			\cdotp \varphi^k_\beta \qty\big(\V{x}(\V{X})) )
		\Bigg] \fullstop
\end{align}
这样，就把一阶和二阶偏导数项全部用关于 $\V{x}$ 的函数\footnote{%
	当然它仍然是 $\V{X}$ 的\emphB{隐}函数：
	$\V{x}=\V{x}(\V{X})$。}表达了出来。
换句话说，我们已经把\emphB{物理域}中 $f$ 关于 $\V{X}$ 的 PDE，
转化成了\emphB{参数域}中 $\tilde{f}$ 关于 $\V{x}$ 的 PDE。
这就是上文要实现的目标。

\subsection{微分同胚的定义}
上文已经指出了 $\domD{\V{x}}$ 到 $\domD{\V{X}}$ 的映照
$\V{X}(\V{x})$ 所需满足的一些条件。这里再次罗列如下:

\begin{myEnum}
\item $\domD{\V{X}},\,\domD{\V{x}}\subset\Rm$
均为\emphA{开集}\footnote{%
	用形象化的语言来说，如果在区域中的任意一点都可以吹出一个球，
	并能使球上的每个点都落在区域内，那么这个区域就是\emphA{开集}。
	这是\emphB{复合映照可微性定理}的一个要求。}；

\item 存在 $\domD{\V{x}}$ 同 $\domD{\V{X}}$ 之间的\emphA{双射}
$\V{X}(\V{x})$，即存在\emphA{一一对应}关系；

\item $\V{X}(\V{x})$ 和它的逆映照 $\V{x}(\V{X})$
满足一定的\emphA{正则性}要求。
\end{myEnum}

\myPROBLEM{对第3点要稍作说明。}

如果满足这三点，则称 $\V{X}(\V{x})$ 为
$\domD{\V{x}}$ 与 $\domD{\V{X}}$ 之间的 \emphA{$\DiffMorp$-微分同胚}，
记为 $\V{X}(\V{x})\in\cf{\domD{\V{x}}}{\domD{\V{X}}}$。
把物理域中的一个部分对应到参数域上的一个部分，需要的仅仅是\emphB{双射}这一条件；
而要使得物理域中所满足的 PDE 能够转换到参数域上，
就需要“过去”和“回来”都满足 $p$ 阶偏导数连续的条件（即\emphB{正则性}要求）。

\section{向量值映照的可微性}
\subsection{可微性的定义}
设 $\V{x}_0$ 是参数域 $\domD{\V{x}}$ 中的一个内点。
在映照 $\V{X}(\V{x})$ 的作用下，
它对应到物理域 $\domD{\V{X}}$ 中的点 $\V{X}\qty(\V{x}_0)$。
参数域是一个\emphB{开集}。根据开集的定义，必然存在一个实数 $\lambda>0$，
使得以 $\V{x}_0$ 为球心、$\lambda$ 为半径的球%
能够完全落在定义域 $\domD{\V{x}}$ 内，即
\begin{equation}
	\domB{\lambda}{\V{x}_0}\subset\domD{\V{x}} \comma
\end{equation}
其中的 $\domB{\lambda}{\V{x}_0}$ 表示 $\V{x}_0$ 的 $\lambda$ 邻域。

如果 $\exists\,\JacobiD{\V{X}}\qty(\V{x}_0)\in\LinearT{\Rm}{\Rm}$
\footnote{正如之前已经定义的，$\JacobiD{\V{X}}$ 已经用来表示 Jacobi 矩阵。
	这里还是请先暂时将它视为一种记号，其具体形式将在下一小节给出。}，满足
\begin{equation}
	\forall\,\V{x}_0+\V{h}\in\domB{\lambda}{\V{x}_0},\quad
	\V{X}\qty(\V{x}_0+\V{h})-\V{X}\qty(\V{x}_0)
	=\JacobiD{\V{X}}\qty(\V{x}_0)(\V{h})+\sO{\norm{\V{h}}}
	\in\Rm \comma
	\label{eq:向量值映照可微性的定义}
\end{equation}
则称向量值映照 $\V{X}(\V{x})$ 在 $\V{x}_0$ 点\emphA{可微}。
其中，$\LinearT{\Rm}{\Rm}$ 表示从 $\Rm$ 到 $\Rm$ 的\emphA{线性变换}全体。

根据这个定义，所谓\emphB{可微性}，指由自变量变化所引起的因变量变化，
可以用一个\emphB{线性变换}近似，而误差为\emphB{一阶}无穷小量。
自变量可见到因变量空间最简单的映照形式就是线性映照（线性变换），
因而具有可微性的向量值映照具有至关重要的作用。

\subsection{Jacobi 矩阵}
下面我们研究 $\JacobiD{\V{X}}\qty(\V{x}_0)\in\LinearT{\Rm}{\Rm}$
的表达形式。由于 $\V{h}\in\Rm$，所以
\begin{equation}
	\V{h}=\mqty[h^1 \\ \vdots \\ h^m]
	=h^1\V{e}_1+\cdots+h^i\V{e}_i+\cdots+h^m\V{e}_m \fullstop
\end{equation}
另一方面，$\JacobiD{\V{X}}\qty(\V{x}_0)\in\LinearT{\Rm}{\Rm}$
具有\emphB{线性性}：
\begin{equation}
	\forall\,\alpha,\,\beta \in\realR
		\text{\ 和\ } \tilde{\V{h}},\,\hat{\V{h}}\in\Rm,\quad
	\JacobiD{\V{X}}\qty(\V{x}_0)
		\qty(\alpha\tilde{\V{h}}+\beta\hat{\V{h}})
	=\alpha \JacobiD{\V{X}}\qty(\V{x}_0)\qty(\tilde{h})
		+\beta \JacobiD{\V{X}}\qty(\V{x}_0)\qty(\hat{h}) \fullstop
\end{equation}
这样就有
\begin{align}
	\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{h})
	&=\JacobiD{\V{X}}\qty(\V{x}_0)
		\qty(h^1\V{e}_1+\cdots+h^i\V{e}_i+\cdots+h^m\V{e}_m) \notag \\
	&=h^1\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_1) + \cdots
		+h^i\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i) + \cdots
		+h^m\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_m)
		\label{eq:推导Jacobi矩阵表达形式_Part1}
	\intertext{注意到 $h^i\in\realR$ 以及
		$\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i)\in\Rm$，
		因而该式可以用矩阵形式表述：}
	&=\mqty[\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_1),\,\cdots,\,
			\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_m)]
		\mqty[h^1 \\ \vdots \\ h^m] \fullstop
\end{align}
最后一步要用到\emphB{分块矩阵}的思想：左侧的矩阵为 1“行” $m$ 列，
每一“行”是一个 $m$ 维列向量；右侧的矩阵（向量）则为 $m$ 行 1 列。
两者相乘，得到 1“行” 1 列的矩阵（当然实际为 $m$ 行），
即之前的 \eqref{eq:推导Jacobi矩阵表达形式_Part1}~式。
在线性代数中，$m \times m$ 的矩阵
$\mqty[\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_1) & \cdots
& \JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_m)]$
通常称为\emphA{变换矩阵}（也叫\emphA{过渡矩阵}）。

接下来要搞清楚变换矩阵的具体形式。取
\begin{equation}
	\V{h}=\mqty[0,\,\cdots,\,\lambda,\,\cdots,\,0]\trans
	=\lambda\,\V{e}_i\in\Rm \comma
\end{equation}
即除了 $\V{h}$ 的第 $i$ 各元素为 $\lambda$ 外，其余元素均为 0
（$\lambda \neq 0$）。因而有 $\norm{\V{h}}=\lambda$。
代入可微性的定义 \eqref{eq:向量值映照可微性的定义}~式，可得
\begin{align}
	&\alspace\V{X}\qty(\V{x}_0+\V{h})-\V{X}\qty(\V{x}_0)
	=\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i)
		-\V{X}\qty(\V{x}_0) \notag \\
	&=\mqty[\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_1),\,\cdots,\,
			\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i),\,\cdots,\,
			\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_m)]
		\mqty[0,\,\cdots,\,\lambda,\,\cdots,\,0]\trans
		+\sO{\lambda} \notag \\
	&=\lambda\cdotp\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i)
		+\sO{\lambda} \fullstop
\end{align}
由于 $\lambda$ 是非零实数，故可以在等式两边同时除以 $\lambda$ 并取极限：
\begin{equation}
	\lim\limits_{\lambda\to 0}
	\frac{\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i)
		-\V{X}\qty(\V{x}_0)}{\lambda}
	=\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i) \comma
\end{equation}
这里的 $\sO{\lambda}$ 根据其定义自然趋于 0。
该式左侧极限中的分子部分，是自变量 $\V{x}$ 第 $i$ 个分量的变化%
所引起因变量的变化；而分母，则是自变量第 $i$ 个分量的变化大小。
我们引入下面的记号：
\begin{equation}
	\pdv{\V{X}}{x^i}\qty(\V{x}_0)
	\coloneq \lim\limits_{\lambda\to 0}
	\frac{\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i)
		-\V{X}\qty(\V{x}_0)}{\lambda} \in\Rm \comma
\end{equation}
它表示因变量 $\V{X}\in\Rm$ 作为一个\emphB{整体}，
相对于自变量 $\V{x}\in\Rm$ 第 $i$ 个\emphB{分量} $x^i\in\realR$
的“变化率”，即 $\V{X}$ 关于 $x^i$（在 $\V{x}_0$ 处）%
的\emphA{偏导数}。由于我们没有定义向量的除法，
因此自变量作为\emphB{整体}所引起因变量的变化，是没有意义的。
利用偏导数的定义，可有
\begin{align}
	&\alspace\mqty[\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_1),\,\cdots,
		\,\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_i),\,\cdots,\,
		\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{e}_m)] \notag \\
	&=\mqty[\displaystyle \pdv{\V{X}}{x^1}\qty(\V{x}_0),\,\cdots,\,
		\displaystyle \pdv{\V{X}}{x^i}\qty(\V{x}_0),\,\cdots,\,
		\displaystyle \pdv{\V{X}}{x^m}\qty(\V{x}_0)]
		\in\realR^{m \times m} \fullstop
\end{align}

\blankline

下面给出 $\pdv*{\V{X}}{x^i}\qty(\V{x}_0)$ 的计算式。根据定义，有
\begin{align}
	\pdv{\V{X}}{x^i}\qty(\V{x}_0)
	&\coloneq \lim\limits_{\lambda\to 0}
		\frac{\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i)
		-\V{X}\qty(\V{x}_0)}{\lambda} \in\Rm \notag \\
	&=\lim\limits_{\lambda\to 0} \frac{1}{\lambda}\cdotp
		\left(\vphantom{\mqty{0\\[0.8ex]0}}\right.\!
			\mqty[X^1 \\ \vdots \\ X^m] \qty(\V{x}_0+\lambda\,\V{e}_i)
			-\mqty[X^1 \\ \vdots \\ X^m] \qty(\V{x}_0)
		\!\!\left.\vphantom{\mqty{0\\[0.8ex]0}}\right) \notag \\
	&=\lim\limits_{\lambda\to 0}\,
		\mqty[
			\dfrac{X^1\qty(\V{x}_0+\lambda\,\V{e}_i)-X^1\qty(\V{x}_0)}
				{\lambda} \\[1ex] \vdots \\[0.5ex]
			\dfrac{X^m\qty(\V{x}_0+\lambda\,\V{e}_i)-X^m\qty(\V{x}_0)}
				{\lambda} ] \fullstop
\end{align}
向量极限存在的\emphB{充要条件}是各分量极限均存在，即存在
\begin{equation}
	\pdv{X^\alpha}{x^i}\qty(\V{x}_0) \coloneq
	\lim\limits_{\lambda\to 0}
	\frac{X^\alpha\qty(\V{x}_0+\lambda\,\V{e}_i)-X^\alpha\qty(\V{x}_0)}
		{\lambda\vphantom{X^1\qty(\V{x}_0)}}\in\realR \comma
\end{equation}
其中的 $\alpha=1,\,\cdots,\,m$。
这其实就是我们熟知的\emphB{多元函数}偏导数的定义。
用它来表示\emphB{向量值映照}的偏导数，可有
\begin{equation}
	\pdv{\V{X}}{x^i}\qty(\V{x}_0)
	=\mqty[\displaystyle \pdv{X^1}{x^i}\qty(\V{x}_0) \\[1ex]
		\vdots \\[0.7ex] \displaystyle \pdv{X^m}{x^i}\qty(\V{x}_0)]
	=\sum_{\alpha=1}^{m} \pdv{X^\alpha}{x^i}\qty(\V{x}_0) \,
		\V{e}_\alpha \fullstop
\end{equation}

向量值映照 $\V{X}$ 关于 $x^i$ 的偏导数，
从代数的角度来看，是 Jacobi 矩阵的第 $i$ 列；
从几何的角度来看，则是物理域中 $x^i$ 线的切向量；
从计算的角度来看，又是（该映照）每个分量偏导数的组合。

\blankline

现在我们重新回到 Jacobi 矩阵。情况已经十分明了：
只需把之前获得的各列并起来，就可以得到完整的 Jacobi 矩阵。于是
\begin{align}
	\JacobiD{\V{X}}\qty(\V{x}_0)\qty(\V{h})
	&=\mqty[\displaystyle \pdv{\V{X}}{x^1},\,\cdots,\,\pdv{\V{X}}{x^m}]
		\qty(\V{x}_0)\qty(\V{h}) \notag \\
	&=\,\mqty[
		\displaystyle\pdv{X^1}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^1}{\displaystyle x^m} \\[1ex]
		\vdots & \ddots & \vdots \\[0.5ex]
		\displaystyle\pdv{X^m}{\displaystyle x^1} & \cdots &
			\displaystyle\pdv{X^m}{\displaystyle x^m}
		]\, \qty(\V{x}_0) \cdotp
		\mqty[h^1 \\ \vdots \\ h^m] \fullstop
\end{align}
这与 \ref{subsec:参数域方程}~小节中
\eqref{eq:参数域方程_Jacobi矩阵}~式给出的定义是完全一致的。

\subsection{偏导数的几何意义} \label{subsec:偏导数的几何意义}
这一小节中，我们要回过头来，澄清向量值映照偏导数的几何意义。

如图~\ref{fig:偏导数的几何意义}，$\V{X}(\V{x})$ 是定义域空间
$\domD{\V{x}}\subset\Rm$ 到值域空间 $\domD{\V{X}}\subset\Rm$
的向量值映照。在定义域空间 $\domD{\V{x}}$ 中，
过点 $\V{x}_0$ 作一条平行于 $x^i$ 轴的直线，称为 \emphB{$x^i$-线}。
$x^i$ 轴定义了向量 $\V{e}_i$，因而 $x^i$-线上的任意一点均可表示为
$\V{x}_0+\lambda\,\V{e}_i$，其中 $\lambda\in\realR$。

\begin{figure}[h]
	\centering
	\includegraphics{Images/Vector-Value_Mapping.PNG}
	\caption{向量值映照偏导数的几何意义}
	\label{fig:偏导数的几何意义}
\end{figure}

在 $\V{X}(\V{x})$ 的作用下，点 $\V{x}_0$ 被映照到 $\V{X}\qty(\V{x}_0)$，
而 $\V{x}_0+\lambda\,\V{e}_i$ 则被映照到了
$\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i)$。这样一来，
$x^i$-线也就被映照到了值域空间 $\domD{\V{X}}$ 中，成为一条曲线。

根据前面的定义，当 $\lambda\to 0$ 时，
\begin{equation}
	\frac{\V{X}\qty(\V{x}_0+\lambda\,\V{e}_i) - \V{X}\qty(\V{x}_0)}
	{\lambda} \to \pdv{\V{X}}{x^i}\qty(\V{x}_0) \fullstop
\end{equation}
对应到图~\ref{fig:偏导数的几何意义} 中，
就是 $x^i$-线（值域空间中）在 $\V{X}\qty(\V{x}_0)$ 处的\emphA{切向量}。

完全类似，在定义域空间 $\domD{\V{x}}$ 中，过点 $\V{x}_0$
作出 \emphB{$x^j$-线}（自然是平行于 $x^j$ 轴），
其上的点可以表示为 $\V{x}_0+\lambda\,\V{e}_j$。
映射到值域空间 $\domD{\V{X}}$ 上，
则成为 $\V{X}\qty(\V{x}_0+\lambda\,\V{e}_j)$。很显然，
\begin{equation}
	\pdv{\V{X}}{x^j}\qty(\V{x}_0)
	=\frac{\V{X}\qty(\V{x}_0+\lambda\,\V{e}_j) - \V{X}\qty(\V{x}_0)}
	{\lambda}
\end{equation}
就是 $x^j$-线在 $\V{X}\qty(\V{x}_0)$ 处的切向量。在定义域空间中，
$x^i$-线作为直线共有 $m$ 条，它们之间互相垂直。作用到值域空间后，
这样的 $x^i$-线尽管变为了曲线，但仍为 $m$ 条。相应的切向量，自然也有 $m$ 个。

\section{局部基}
这里的讨论基于曲线坐标系（即微分同胚）
$\V{X}(\V{x})\in\cf{\domD{\V{x}}}{\domD{\V{X}}}$。

我们已经知道，$\V{X}(\V{x})$ 的 Jacobi 矩阵可以表示为
\begin{equation}
	\JacobiD{\V{X}}(\V{x})
	=\mqty[\displaystyle \pdv{\V{X}}{x^1},\,\cdots,\,
		\displaystyle \pdv{\V{X}}{x^i},\,\cdots,\,
		\displaystyle \pdv{\V{X}}{x^m}] (\V{x})
		\in\realR^{m \times m} \comma
\end{equation}
式中的
\begin{equation}
	\pdv{\V{X}}{x^i} (\V{x})
	=\lim\limits_{\lambda\to 0}
		\frac{\V{X}\qty(\V{x}+\lambda\,\V{e}_i) - \V{X}(\V{x})}
		{\lambda} \fullstop
	\label{eq:局部基_偏导数}
\end{equation}
在参数域 $\domD{\V{x}}$ 中作出 $x^i$-线。映照到物理域后，它变成一条曲线，
我们仍称之为 $x^i$-线。\ref{subsec:偏导数的几何意义}~小节已经说明，
\eqref{eq:局部基_偏导数}~式表示物理域中 $x^i$-线的\emphB{切向量}。
在张量分析中，我们通常把它记作 $\V{g}_i(\V{x})$。

由于微分同胚要求是\emphB{双射}，因而 Jacobi 矩阵
\begin{equation}
	\JacobiD{\V{X}}(\V{x})
	=\mqty[\V{g}_1,\,\cdots,\,\V{g}_i,\,\cdots,\,\V{g}_m](\V{x})
	\in\realR^{m \times m}
\end{equation}
必须是\emphB{非奇异}的。这等价于
\begin{equation}
	\qty{\V{g}_i(\V{x})=\pdv{\V{X}}{x^i} (\V{x})}^m_{i=1}
	\subset\Rm
\end{equation}
\emphB{线性无关}。由此，它们可以构成 $\Rm$ 上的一组\emphA{基}。

用任意的 $\V{x}\in\domD{\V{x}}$ 均可构建一组基。但选取不同的 $\V{x}$，
将会使所得基的取向有所不同。因而这种基称为\emphA{局部协变基}。
和之前一样，我们用“协变”表示指标在下方。

\blankline

有了局部协变基 $\qty{\V{g}_i(\V{x})}^m_{i=1}$，根据
\ref{subsec:对偶基}~小节中的讨论，必然唯一存在与之对应的\emphA{局部逆变基}
$\qty{\V{g}^i(\V{x})}^m_{i=1}$，满足
\begin{equation}
	\mqty[\V{g}^1(\V{x}),\,\cdots,\,\V{g}^m(\V{x})]\trans
		\mqty[\V{g}_1(\V{x}),\,\cdots,\,\V{g}_m(\V{x})]
	=\mqty[\qty(\V{g}^1)\trans \\ \vdots \\ \qty(\V{g}^m)\trans]\,
		(\V{x}) \cdotp \JacobiD{\V{X}}(\V{x})
	=\Mat{I}_m \fullstop
\end{equation}

下面我们来寻找逆变基 $\qty{\V{g}^i(\V{x})}^m_{i=1}$ 的具体表示。考虑到
\footnote{这里的几步推导在 \ref{subsec:参数域方程}~小节中也有所涉及。}
\begin{equation}
	\V{X}\qty\big(\V{x}(\V{X}))=\V{X}\in\Rm \comma
\end{equation}
并利用复合映照可微性定理，可知
\begin{equation}
	\JacobiD{\V{X}}\qty\big(\V{x}(\V{X}))
	\cdotp \JacobiD{\V{x}}(\V{X})
	=\Mat{I}_m \comma
\end{equation}
即有
\begin{equation}
	\JacobiD{\V{x}}(\V{X})
	=(\JacobiD{\V{X}})^{-1}\qty\big(\V{x}(\V{X})) \fullstop
\end{equation}
于是
\begin{equation}
	\mqty[\qty(\V{g}^1)\trans \\ \vdots \\ \qty(\V{g}^m)\trans]\,
		(\V{x})
	=(\JacobiD{\V{X}})^{-1}(\V{x})
	=\JacobiD{\V{x}}(\V{X})
	=\mqty[
		\displaystyle\pdv{x^1}{\displaystyle X^1} & \cdots &
			\displaystyle\pdv{x^1}{\displaystyle X^m} \\[1ex]
		\vdots & \ddots & \vdots \\[0.5ex]
		\displaystyle\pdv{x^m}{\displaystyle X^1} & \cdots &
			\displaystyle\pdv{x^m}{\displaystyle X^m} ]\,(\V{X}) \fullstop
\end{equation}
这样我们就得到了局部逆变基的具体表示（注意转置）：
\begin{equation}
	\V{g}^i(\V{x})
	=\mqty[\displaystyle \pdv{x^i}{X^1} \\[1ex]
		\vdots \\[0.5ex] \displaystyle \pdv{x^i}{X^m}]\,(\V{X})
	=\sum_{\alpha=1}^{m} \pdv{x^i}{X^\alpha} (\V{X})\,\V{e}_\alpha
	\fullstop
\end{equation}
定义标量场 $f(\V{x})$ 的\emphA{梯度}为
\begin{equation}
	\nabla f(\V{x}) \defeq
	\sum_{\alpha=1}^{m} \pdv{f}{x^\alpha} (\V{x})\,\V{e}_\alpha \comma
\end{equation}
则局部逆变基又可以表示成
\begin{equation}
	\V{g}^i(\V{x})=\nabla x^i(\V{X}) \fullstop
\end{equation}
这里的梯度实际上就是我们熟知的三维情况在 $m$ 维下的推广。